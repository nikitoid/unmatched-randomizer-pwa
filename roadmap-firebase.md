# Roadmap: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Firebase –¥–ª—è –æ–±–ª–∞—á–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–ª–∞–Ω –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Firebase Realtime Database –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –æ–±–ª–∞—á–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª—è: `FirebaseManager` –¥–ª—è –ø—Ä—è–º–æ–π —Ä–∞–±–æ—Ç—ã —Å API Firebase –∏ `OfflineManager` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å–µ—Ç–∏ –∏ –æ—á–µ—Ä–µ–¥–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏. `ListManager` –∏ `Storage` –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ —Å–ø–∏—Å–∫–æ–≤ ‚Äî `cloud`.

```mermaid
graph TD
    subgraph "–ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
        UI <--> App.js
        App.js <--> ListManager
        ListManager <--> Storage
        ListManager <--> OfflineManager
        OfflineManager -- "–î–µ–π—Å—Ç–≤–∏—è (sync, fetch, delete)" --> FirebaseManager
        UI -- "–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞" --> OfflineManager
    end

    subgraph "–í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã"
        FirebaseManager -- "REST API / SDK" --> FirebaseDB[(Firebase Realtime DB)]
    end

    App.js -- "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è" --> FirebaseManager
    App.js -- "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è" --> OfflineManager
```

---

## üìã –ü–ª–∞–Ω —Ä–∞–±–æ—Ç

### –≠—Ç–∞–ø 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase

1.  **–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `js/modules/firebase.js`:**
    - –≠—Ç–æ—Ç –º–æ–¥—É–ª—å –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∑–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é Firebase.
    - –û–Ω –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `initFirebase()`, –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.
    - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –±—Ä–∞—Ç—å—Å—è –∏–∑ `import.meta.env.VITE_FIREBASE_CONFIG` (–¥–ª—è Vite) –∏–ª–∏ `process.env` (–¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–±–æ—Ä—â–∏–∫–æ–≤). –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è Netlify.
    - –§—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω–µ—Ç –∏–Ω—Å—Ç–∞–Ω—Å—ã `app` –∏ `database`.
2.  **–û–±–Ω–æ–≤–∏—Ç—å `index.html`:**
    - –ü–æ–¥–∫–ª—é—á–∏—Ç—å Firebase SDK —á–µ—Ä–µ–∑ CDN –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –í –¥–∞–ª—å–Ω–µ–π—à–µ–º –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ npm-–ø–∞–∫–µ—Ç.
    - ```html
      <!-- –ü–µ—Ä–µ–¥ –≤–∞—à–∏–º –æ—Å–Ω–æ–≤–Ω—ã–º —Å–∫—Ä–∏–ø—Ç–æ–º app.js -->
      <script type="module">
        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Netlify
        if (window.netlify) {
          window.process = {
            env: {
              ...window.netlify.env,
            },
          };
        }
      </script>
      <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
      <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
      ```
3.  **–û–±–Ω–æ–≤–∏—Ç—å `app.js`:**
    - –í—ã–∑–≤–∞—Ç—å `initFirebase()` –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

### –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥—É–ª—è `FirebaseManager`

1.  **–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `js/modules/firebase-manager.js`:**
    - –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `FirebaseManager`.
    - –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å `database` –∏–∑ `firebase.js`.
    - **–ú–µ—Ç–æ–¥—ã:**
      - `constructor(database)`: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–Ω—Å—Ç–∞–Ω—Å –ë–î.
      - `isOnline()`: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Firebase (`.info/connected`).
      - `syncList(listId, content)`: –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∞ –ø–æ –ø—É—Ç–∏ `/lists/main/lists/{listId}`.
      - `fetchList(listId)`: –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∞ –∏–∑ –æ–±–ª–∞–∫–∞.
      - `deleteCloudList(listId)`: –£–¥–∞–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ –æ–±–ª–∞–∫–∞.
      - `getRef(listId)`: –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –ø—É—Ç—å –≤ –ë–î.

### –≠—Ç–∞–ø 3: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥—É–ª—è `OfflineManager`

1.  **–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `js/modules/offline-manager.js`:**
    - –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `OfflineManager`.
    - **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ç–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—ã–µ `window.addEventListener('online', ...)` –∏ `window.addEventListener('offline', ...)`
    - **–ú–µ—Ç–æ–¥—ã:**
      - `constructor(firebaseManager)`: –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `FirebaseManager`.
      - `init()`: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–ª—É—à–∞—Ç–µ–ª–µ–π `online`/`offline`.
      - `checkConnection()`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–µ—Ç–∏.
      - `enableOfflineMode()`: –ë–ª–æ–∫–∏—Ä—É–µ—Ç UI –¥–ª—è –æ–±–ª–∞—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `Toast` —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.
      - `enableOnlineMode()`: –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç UI, –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.
      - `queueAction(action)`: –î–æ–±–∞–≤–ª—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `{ type: 'sync', listId: 'myList', content: [...] }`) –≤ –æ—á–µ—Ä–µ–¥—å –≤ `localStorage`.

### –≠—Ç–∞–ø 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `ListManager` –∏ `Storage`

1.  **–û–±–Ω–æ–≤–∏—Ç—å `js/modules/storage.js`:**
    - –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—ç—à–µ–º –æ–±–ª–∞—á–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤:
      - `cacheCloudLists(lists)`
      - `loadCloudListsFromCache()`
    - –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è –æ—á–µ—Ä–µ–¥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
      - `getSyncQueue()`
      - `saveSyncQueue(queue)`
2.  **–û–±–Ω–æ–≤–∏—Ç—å `js/modules/listManager.js`:**
    - –ü—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ —Å–ø–∏—Å–∫–æ–≤ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏—Ö —Ç–∏–ø (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏–ª–∏ `cloud`).
    - –î–ª—è –æ–±–ª–∞—á–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤ (`cloud`) –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è, –µ—Å–ª–∏ `OfflineManager.checkConnection()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `false`.
    - –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –æ–±–ª–∞—á–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤.

### –≠—Ç–∞–ø 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI

1.  **–í `listManager.js`:**
    - –†—è–¥–æ–º —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –æ–±–ª–∞—á–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –∏–∫–æ–Ω–∫—É "–æ–±–ª–∞–∫–∞" ‚òÅÔ∏è.
    - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ü–≤–µ—Ç –∏–∫–æ–Ω–∫–∏: —Å–µ—Ä—ã–π - –æ—Ñ–ª–∞–π–Ω, –∂–µ–ª—Ç—ã–π - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –∑–µ–ª–µ–Ω—ã–π - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ).
2.  **–í `toast.js`:**
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ç–∏ ("–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É", "–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ").
3.  **–í `index.html`:**
    - –î–æ–±–∞–≤–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ç–∏ –≥–¥–µ-–Ω–∏–±—É–¥—å –≤ —à–∞–ø–∫–µ –∏–ª–∏ –ø–æ–¥–≤–∞–ª–µ.

### –≠—Ç–∞–ø 6: –î–µ–ø–ª–æ–π –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Netlify

1.  **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Netlify:**
    - –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `FIREBASE_CONFIG` –∏ –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤ –Ω–µ–µ JSON-—Å—Ç—Ä–æ–∫—É —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π Firebase.
2.  **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å `_headers`:**
    - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ –º–µ—à–∞—é—Ç —Ä–∞–±–æ—Ç–µ Service Worker –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
3.  **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
    - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –æ–Ω–ª–∞–π–Ω –∏ –æ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞—Ö –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è.
    - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–±–ª–∞—á–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è.

---

–≠—Ç–æ—Ç –ø–ª–∞–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ—à–∞–≥–æ–≤—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞.
